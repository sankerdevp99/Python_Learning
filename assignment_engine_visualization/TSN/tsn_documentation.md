# Time-Space Network Documentation

## Introduction

This documentation outlines the process of creating a Time-Space Network (TSN) for scheduling trucks. The process involves using data from two Excel sheets, configuring parameters, and generating schedules. The following files and scripts are involved in this process:

1. `nodes_junctions_xy.xlsx`
2. `distance_matrix.xlsx`
3. `CommonProperties.yaml`
4. `create_all_states.py`
5. `tsn_less_arc.py`

## Requirements

The code is written in Python 3. The following external libraries need to be installed:

- `pandas`
- `yaml`
- `ortools`

You can install these libraries using pip:


## Excel Sheets

### nodes_junctions_xy.xlsx

This file can be found in `Common_Files` folder and it contains the following information about nodes:

- **Location Information**: Coordinates of nodes (loading stations, unloading stations, and junctions).
- **Distances**: Distance between the nodes.
- **Connections**: Information on how nodes are connected.
- **Material Information**: Amount of material available/required.
- **Process Time Information**: Time required to complete the process at each state.

### distance_matrix.xlsx

This file also stored in `Common_Files` folder and it contains a matrix representing the distances between any connected nodes.

## Parameter File

### CommonProperties.yaml

This YAML file is located inside the `Common_Files` folder. It contains configurable parameters for the network. Key parameters include `Number of Trucks`, `Truck Capacity`, `Velocity of Loaded Truck`, `Velocity of Unloaded Truck`, etc.


## Script Files
scripts files to generate schdeule from time space network are located inside `TSN` folder.
### create_all_states.py

This script reads data from `nodes_junctions_xy.xlsx` and `distance_matrix.xlsx`, and creates an output file named `all_states.xlsx`. This file contains all the necessary states and information required to construct the TSN.

### tsn_less_arc.py

After generating `all_states.xlsx`, this script is executed to determine schedules for each truck. The script utilizes Google OR-Tools to create the mathematical model and solve for truck assignments. The output will be saved as a txt file, a json file, and an lp file inside the `Results` folder. If no solution is obtained, consider increasing the num_time_steps.

## Workflow

1. **Prepare Excel Sheets**:
    - Ensure `nodes_junctions_xy.xlsx` and `distance_matrix.xlsx` are up to date with accurate information about the nodes and distances with respect to the current map of the minining site.

2. **Configure Parameters**:
    - Edit `CommonProperties.yaml` to set the number of trucks, their capacities, and other relevant parameters.

3. **Generate All States**:
    - Open Assignment Engine folder in any Python IDE
    - Run `create_all_states.py` to generate `all_states.xlsx` which contains all the necessary states and information for the TSN.


4. **Generate Schedules**:
    - Run `tsn_less_arc.py` to compute the schedules for each truck. The schedules will be saved in `output.json`.


## Output Files

output files will be stored in `Results` folder

- **schedules_unformated.txt"** : This text file will be storing schedule generated by TSN model. The each schedule will be a list of string where the strings are the state name mentioned exactly as in the `all_states.xlsx` file. 
- **output.json**: This file ontains the schedules for each truck in node format. This file is made such a way that it can directly be tested using discrete event simulator by importing this file. 
- **LP_YY_MM_DD_H_M_S.lp**: This file stores all the variables,constraints and objective function generated by the `tsn_less_arc.py` file. This can be used to debug the mathematical model used in TSN
 


